@startuml ComponentDiagram
title GraphJudge Component Architecture\n//<color:gray>(How is it composed?)</color>//

skinparam component {
    BackgroundColor<<Agent>> #E8D5F2
    BackgroundColor<<Core>> #C8E6C9
    BackgroundColor<<Eval>> #B3E5FC
    BackgroundColor<<External>> #FFECB3
    BackgroundColor<<Common>> #FFE0B2
    BackgroundColor<<Role>> #FFCDD2
}

skinparam package {
    BackgroundColor #FAFAFA
}

' Top: Shared infrastructure
package "Common Module" <<Common>> #FFE0B2 {
    component [Models] as Models
    component [Messenger] as CommonMessenger
    component [TraceReporter] as TraceReporter
    component [LLMClient] as LLMFactory
    component [TraceCollectionConfig] as TraceCollectionCfg
}

component [LLM API] as LLMApi <<External>> #FFECB3

' Middle: Agent packages side by side
package "Purple Agents (Assessee, Example Config)" <<Agent>> #E8D5F2 {
    component [Executor] as PurpleExec

    package "Roles" <<Role>> #FFCDD2 {
        component [Coordinator] as CoordRole
        component [Researcher] as ResearchRole
        component [Synthesizer] as SynthRole
    }

    PurpleExec -down-> CoordRole
    PurpleExec -down-> ResearchRole
    PurpleExec -down-> SynthRole
    CoordRole <--> ResearchRole : delegate
}

package "Green Agent (Assessor)" <<Core>> #C8E6C9 {
    component [TraceStore] as TraceStore
    component [Executor] as GreenExec

    package "Evaluators" <<Eval>> #B3E5FC {
        component [BaseEvaluator] as BaseEval
        component [Graph] as GraphEval
        component [LLM Judge] as LLMEval
        component [Latency] as LatencyEval

        GraphEval -up-|> BaseEval
        LLMEval -up-|> BaseEval
        LatencyEval -up-|> BaseEval
    }

    TraceStore -down-> GreenExec
    GreenExec -down-> GraphEval
    GreenExec -down-> LLMEval
    GreenExec -down-> LatencyEval
}

' Cross-package flows
PurpleExec -right-> TraceStore : traces
LLMFactory -right-> LLMApi
TraceCollectionCfg .down.> GreenExec : adaptive collection

note bottom of LLMFactory
  Used by:
  • Purple (roles)
  • Green (orchestration)
  • LLM Judge (eval)
end note

@enduml
